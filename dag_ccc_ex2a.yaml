apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: wf-ccc-ex2-automl-dataset-
  annotations: {pipelines.kubeflow.org/kfp_sdk_version: 1.8.14, pipelines.kubeflow.org/pipeline_compilation_time: '2023-02-22T09:10:55.355040',
    pipelines.kubeflow.org/pipeline_spec: '{"inputs": [{"default": "demo", "name":
      "in_prefix", "optional": true, "type": "String"}, {"default": "projektccc",
      "name": "in_bigquery_projectid", "optional": true, "type": "String"}, {"default":
      "crm_cookie_match", "name": "in_bigquery_dataset", "optional": true, "type":
      "String"}, {"default": "crm_cookie_match", "name": "in_bigquery_table", "optional":
      true, "type": "String"}, {"default": "defaultprojectid", "name": "in_vertexai_projectid",
      "optional": true, "type": "String"}, {"default": "us-central1", "name": "in_vertexai_region",
      "optional": true, "type": "String"}], "name": "wf-ccc-ex2-automl-dataset"}'}
  labels: {pipelines.kubeflow.org/kfp_sdk_version: 1.8.14}
spec:
  entrypoint: wf-ccc-ex2-automl-dataset
  templates:
  - name: automl-tabular-training-job
    container:
      args:
      - --init.project
      - '{{inputs.parameters.in_vertexai_projectid}}'
      - --init.location
      - us-central1
      - --init.display_name
      - train-automl-{{inputs.parameters.in_prefix}}
      - --init.optimization_prediction_type
      - classification
      - --method.dataset
      - '{{$.inputs.artifacts[''dataset''].metadata[''resourceName'']}}'
      - --method.target_column
      - y_if_trans
      - --init.optimization_objective
      - maximize-au-roc
      - --init.column_specs
      - '{"app_add_to_wishlist_month_freq_1": "numeric", "app_add_to_wishlist_month_freq_2":
        "numeric", "app_add_to_wishlist_month_freq_3": "numeric", "app_search_freq_month_freq_1":
        "numeric", "app_search_freq_month_freq_2": "numeric", "app_search_freq_month_freq_3":
        "numeric", "app_select_promotion_month_freq_1": "numeric", "app_select_promotion_month_freq_2":
        "numeric", "app_select_promotion_month_freq_3": "numeric", "app_sessions_freq_month_freq_1":
        "numeric", "app_sessions_freq_month_freq_2": "numeric", "app_sessions_freq_month_freq_3":
        "numeric", "app_view_item_month_freq_1": "numeric", "app_view_item_month_freq_2":
        "numeric", "app_view_item_month_freq_3": "numeric", "crm_club_level_id": "numeric",
        "crm_store_purchase_month_freq_1": "numeric", "crm_store_purchase_month_freq_2":
        "numeric", "crm_store_purchase_month_freq_3": "numeric", "weight": "numeric",
        "www_basket_freq_sku": "numeric", "www_basket_value_monthly_1": "numeric",
        "www_basket_value_monthly_2": "numeric", "www_basket_value_monthly_3": "numeric",
        "www_channel_freq__afiliacja": "numeric", "www_channel_freq__direct_organic":
        "numeric", "www_channel_freq__facebook": "numeric", "www_channel_freq__klub":
        "numeric", "www_channel_freq__porownywarki": "numeric", "www_channel_freq__portale":
        "numeric", "www_channel_freq__retargeting": "numeric", "www_channel_freq__sem":
        "numeric", "www_channel_freq__traffic": "numeric", "www_coupon_add_month_1":
        "numeric", "www_coupon_add_month_2": "numeric", "www_coupon_add_month_3":
        "numeric", "www_device_freq_desktop": "numeric", "www_device_freq_mobile":
        "numeric", "www_esizeme_freq_esizeme_filtr": "numeric", "www_esizeme_freq_esizme_applied":
        "numeric", "www_gallery_click_month_1": "numeric", "www_gallery_click_month_2":
        "numeric", "www_gallery_click_month_3": "numeric", "www_pages_visited_month_1":
        "numeric", "www_pages_visited_month_2": "numeric", "www_pages_visited_month_3":
        "numeric", "www_product_trans_freq_damskie_buty": "numeric", "www_product_trans_freq_dzieciece":
        "numeric", "www_product_trans_freq_meskie_buty": "numeric", "www_product_trans_freq_torby":
        "numeric", "www_promo_click_month_1": "numeric", "www_promo_click_month_2":
        "numeric", "www_promo_click_month_3": "numeric", "www_time_onsite_avg_month_1":
        "numeric", "www_time_onsite_avg_month_2": "numeric", "www_time_onsite_avg_month_3":
        "numeric", "www_trans_month_freq_1": "numeric", "www_trans_month_freq_2":
        "numeric", "www_trans_month_freq_3": "numeric", "www_umbrella_click_month_1":
        "numeric", "www_umbrella_click_month_2": "numeric", "www_umbrella_click_month_3":
        "numeric", "www_visits_add_fav_1": "numeric", "www_visits_add_fav_2": "numeric",
        "www_visits_add_fav_3": "numeric", "www_visits_month_freq_1": "numeric", "www_visits_month_freq_2":
        "numeric", "www_visits_month_freq_3": "numeric", "y_if_trans": "numeric"}'
      - --init.labels
      - '{}'
      - --method.training_fraction_split
      - '0.6'
      - --method.validation_fraction_split
      - '0.2'
      - --method.test_fraction_split
      - '0.2'
      - --method.weight_column
      - weight
      - --method.budget_milli_node_hours
      - '2000'
      - --method.model_display_name
      - promo-classification-automl-{{inputs.parameters.in_prefix}}
      - --method.disable_early_stopping
      - "False"
      - --method.export_evaluated_data_items
      - "False"
      - --executor_input
      - '{{$}}'
      - --resource_name_output_artifact_uri
      - '{{$.outputs.artifacts[''model''].uri}}'
      command: [python3, -m, google_cloud_pipeline_components.container.aiplatform.remote_runner,
        --cls_name, AutoMLTabularTrainingJob, --method_name, run]
      image: gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33
    inputs:
      parameters:
      - {name: in_prefix}
      - {name: in_vertexai_projectid}
      artifacts:
      - {name: tabular-dataset-create-dataset, path: /tmp/inputs/dataset/data}
    outputs:
      artifacts:
      - {name: automl-tabular-training-job-model, path: /tmp/outputs/model/data}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.14
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
      annotations: {pipelines.kubeflow.org/component_spec: '{"description": "Runs
          the training job and returns a model.\nIf training on a Vertex AI dataset,
          you can use one of the following split configurations:\n    Data fraction
          splits:\n    Any of ``training_fraction_split``, ``validation_fraction_split``
          and\n    ``test_fraction_split`` may optionally be provided, they must sum
          to up to 1. If\n    the provided ones sum to less than 1, the remainder
          is assigned to sets as\n    decided by Vertex AI. If none of the fractions
          are set, by default roughly 80%\n    of data will be used for training,
          10% for validation, and 10% for test.\n    Predefined splits:\n    Assigns
          input data to training, validation, and test sets based on the value of
          a provided key.\n    If using predefined splits, ``predefined_split_column_name``
          must be provided.\n    Supported only for tabular Datasets.\n    Timestamp
          splits:\n    Assigns input data to training, validation, and test sets\n    based
          on a provided timestamps. The youngest data pieces are\n    assigned to
          training set, next to validation set, and the oldest\n    to the test set.\n    Supported
          only for tabular Datasets.\nArgs:\n    dataset (datasets.TabularDataset):\n        Required.
          The dataset within the same Project from which data will be used to train
          the Model. The\n        Dataset must use schema compatible with Model being
          trained,\n        and what is compatible should be described in the used\n        TrainingPipeline''s
          [training_task_definition]\n        [google.cloud.aiplatform.v1beta1.TrainingPipeline.training_task_definition].\n        For
          tabular Datasets, all their data is exported to\n        training, to pick
          and choose from.\n    target_column (String):\n        Required. The name
          of the column values of which the Model is to predict.\n    training_fraction_split
          (Float):\n        Optional. The fraction of the input data that is to be
          used to train\n        the Model. This is ignored if Dataset is not provided.\n    validation_fraction_split
          (Float):\n        Optional. The fraction of the input data that is to be
          used to validate\n        the Model. This is ignored if Dataset is not provided.\n    test_fraction_split
          (Float):\n        Optional. The fraction of the input data that is to be
          used to evaluate\n        the Model. This is ignored if Dataset is not provided.\n    predefined_split_column_name
          (String):\n        Optional. The key is a name of one of the Dataset''s
          data\n        columns. The value of the key (either the label''s value or\n        value
          in the column) must be one of {``training``,\n        ``validation``, ``test``},
          and it defines to which set the\n        given piece of data is assigned.
          If for a piece of data the\n        key is not present or has an invalid
          value, that piece is\n        ignored by the pipeline.\n        Supported
          only for tabular and time series Datasets.\n    timestamp_split_column_name
          (String):\n        Optional. The key is a name of one of the Dataset''s
          data\n        columns. The value of the key values of the key (the values
          in\n        the column) must be in RFC 3339 `date-time` format, where\n        `time-offset`
          = `\"Z\"` (e.g. 1985-04-12T23:20:50.52Z). If for a\n        piece of data
          the key is not present or has an invalid value,\n        that piece is ignored
          by the pipeline.\n        Supported only for tabular and time series Datasets.\n        This
          parameter must be used with training_fraction_split, validation_fraction_split
          and test_fraction_split.\n    weight_column (String):\n        Optional.
          Name of the column that should be used as the weight column.\n        Higher
          values in this column give more importance to the row\n        during Model
          training. The column must have numeric values between 0 and\n        10000
          inclusively, and 0 value means that the row is ignored.\n        If the
          weight column field is not set, then all rows are assumed to have\n        equal
          weight of 1.\n    budget_milli_node_hours (Integer):\n        Optional.
          The train budget of creating this Model, expressed in milli node\n        hours
          i.e. 1,000 value in this field means 1 node hour.\n        The training
          cost of the model will not exceed this budget. The final\n        cost will
          be attempted to be close to the budget, though may end up\n        being
          (even) noticeably smaller - at the backend''s discretion. This\n        especially
          may happen when further model training ceases to provide\n        any improvements.\n        If
          the budget is set to a value known to be insufficient to train a\n        Model
          for the given training set, the training won''t be attempted and\n        will
          error.\n        The minimum value is 1000 and the maximum is 72000.\n    model_display_name
          (String):\n        Optional. If the script produces a managed Vertex AI
          Model. The display name of\n        the Model. The name can be up to 128
          characters long and can be consist\n        of any UTF-8 characters.\n        If
          not provided upon creation, the job''s display_name is used.\n    model_labels
          (JsonObject):\n        Optional. The labels with user-defined metadata to\n        organize
          your Models.\n        Label keys and values can be no longer than 64\n        characters
          (Unicode codepoints), can only\n        contain lowercase letters, numeric
          characters,\n        underscores and dashes. International characters\n        are
          allowed.\n        See https://goo.gl/xmQnxf for more information\n        and
          examples of labels.\n    model_id (String):\n        Optional. The ID to
          use for the Model produced by this job,\n        which will become the final
          component of the model resource name.\n        This value may be up to 63
          characters, and valid characters\n        are `[a-z0-9_-]`. The first character
          cannot be a number or hyphen.\n    parent_model (String):\n        Optional.
          The resource name or model ID of an existing model.\n        The new model
          uploaded by this job will be a version of `parent_model`.\n        Only
          set this field when training a new version of an existing model.\n    is_default_version
          (Boolean):\n        Optional. When set to True, the newly uploaded model
          version will\n        automatically have alias \"default\" included. Subsequent
          uses of\n        the model produced by this job without a version specified
          will\n        use this \"default\" version.\n        When set to False,
          the \"default\" alias will not be moved.\n        Actions targeting the
          model version produced by this job will need\n        to specifically reference
          this version by ID or alias.\n        New model uploads, i.e. version 1,
          will always be \"default\" aliased.\n    model_version_aliases (JsonArray):\n        Optional.
          User provided version aliases so that the model version\n        uploaded
          by this job can be referenced via alias instead of\n        auto-generated
          version ID. A default version alias will be created\n        for the first
          version of the model.\n        The format is [a-z][a-zA-Z0-9-]{0,126}[a-z0-9]\n    model_version_description
          (String):\n       Optional. The description of the model version being uploaded
          by this job.\n    disable_early_stopping (Boolean):\n        Required. If
          true, the entire budget is used. This disables the early stopping\n        feature.
          By default, the early stopping feature is enabled, which means\n        that
          training might stop before the entire training budget has been\n        used,
          if further training does no longer brings significant improvement\n        to
          the model.\n    export_evaluated_data_items (Boolean):\n        Whether
          to export the test set predictions to a BigQuery table.\n        If False,
          then the export is not performed.\n    export_evaluated_data_items_bigquery_destination_uri
          (String):\n        Optional. URI of desired destination BigQuery table for
          exported test set predictions.\n        Expected format:\n        ``bq://<project_id>:<dataset_id>:<table>``\n        If
          not specified, then results are exported to the following auto-created BigQuery\n        table:\n        ``<project_id>:export_evaluated_examples_<model_name>_<yyyy_MM_dd''T''HH_mm_ss_SSS''Z''>.evaluated_examples``\n        Applies
          only if [export_evaluated_data_items] is True.\n    export_evaluated_data_items_override_destination
          (Boolean):\n        Whether to override the contents of [export_evaluated_data_items_bigquery_destination_uri],\n        if
          the table exists, for exported test set predictions. If False, and the\n        table
          exists, then the training job will fail.\n        Applies only if [export_evaluated_data_items]
          is True and\n        [export_evaluated_data_items_bigquery_destination_uri]
          is specified.\n    display_name (String):\n        Required. The user-defined
          name of this TrainingPipeline.\n    optimization_prediction_type (String):\n        The
          type of prediction the Model is to produce.\n        \"classification\"
          - Predict one out of multiple target values is\n        picked for each
          row.\n        \"regression\" - Predict a value based on its relation to
          other values.\n        This type is available only to columns that contain\n        semantically
          numeric values, i.e. integers or floating\n        point number, even if
          stored as e.g. strings.\n    optimization_objective (String):\n        Optional.
          Objective function the Model is to be optimized towards. The training\n        task
          creates a Model that maximizes/minimizes the value of the objective\n        function
          over the validation set.\n        The supported optimization objectives
          depend on the prediction type, and\n        in the case of classification
          also the number of distinct values in the\n        target column (two distint
          values -> binary, 3 or more distinct values\n        -> multi class).\n        If
          the field is not set, the default objective function is used.\n        Classification
          (binary):\n        \"maximize-au-roc\" (default) - Maximize the area under
          the receiver\n                                    operating characteristic
          (ROC) curve.\n        \"minimize-log-loss\" - Minimize log loss.\n        \"maximize-au-prc\"
          - Maximize the area under the precision-recall curve.\n        \"maximize-precision-at-recall\"
          - Maximize precision for a specified\n                                        recall
          value.\n        \"maximize-recall-at-precision\" - Maximize recall for a
          specified\n                                        precision value.\n        Classification
          (multi class):\n        \"minimize-log-loss\" (default) - Minimize log loss.\n        Regression:\n        \"minimize-rmse\"
          (default) - Minimize root-mean-squared error (RMSE).\n        \"minimize-mae\"
          - Minimize mean-absolute error (MAE).\n        \"minimize-rmsle\" - Minimize
          root-mean-squared log error (RMSLE).\n    column_specs (JsonObject):\n        Optional.
          Alternative to column_transformations where the keys of the dict\n        are
          column names and their respective values are one of\n        AutoMLTabularTrainingJob.column_data_types.\n        When
          creating transformation for BigQuery Struct column, the column\n        should
          be flattened using \".\" as the delimiter. Only columns with no child\n        should
          have a transformation.\n        If an input column has no transformations
          on it, such a column is\n        ignored by the training, except for the
          targetColumn, which should have\n        no transformations defined on.\n        Only
          one of column_transformations or column_specs should be passed.\n    column_transformations
          (List[Dict[str, Dict[str, str]]]):\n        Optional. Transformations to
          apply to the input columns (i.e. columns other\n        than the targetColumn).
          Each transformation may produce multiple\n        result values from the
          column''s value, and all are used for training.\n        When creating transformation
          for BigQuery Struct column, the column\n        should be flattened using
          \".\" as the delimiter. Only columns with no child\n        should have
          a transformation.\n        If an input column has no transformations on
          it, such a column is\n        ignored by the training, except for the targetColumn,
          which should have\n        no transformations defined on.\n        Only
          one of column_transformations or column_specs should be passed.\n        Consider
          using column_specs as column_transformations will be deprecated eventually.\n    optimization_objective_recall_value
          (Float):\n        Optional. Required when maximize-precision-at-recall optimizationObjective
          was\n        picked, represents the recall value at which the optimization
          is done.\n        The minimum value is 0 and the maximum is 1.0.\n    optimization_objective_precision_value
          (Float):\n        Optional. Required when maximize-recall-at-precision optimizationObjective
          was\n        picked, represents the precision value at which the optimization
          is\n        done.\n        The minimum value is 0 and the maximum is 1.0.\n    project
          (String):\n        Required. project to retrieve dataset from.\n    location
          (String):\n        Optional location to retrieve dataset from.\n    labels
          (JsonObject):\n        Optional. The labels with user-defined metadata to\n        organize
          TrainingPipelines.\n        Label keys and values can be no longer than
          64\n        characters (Unicode codepoints), can only\n        contain lowercase
          letters, numeric characters,\n        underscores and dashes. International
          characters\n        are allowed.\n        See https://goo.gl/xmQnxf for
          more information\n        and examples of labels.\n    training_encryption_spec_key_name
          (Optional[String]):\n        Optional. The Cloud KMS resource identifier
          of the customer\n        managed encryption key used to protect the training
          pipeline. Has the\n        form:\n        ``projects/my-project/locations/my-region/keyRings/my-kr/cryptoKeys/my-key``.\n        The
          key needs to be in the same region as where the compute\n        resource
          is created.\n        If set, this TrainingPipeline will be secured by this
          key.\n        Note: Model trained by this TrainingPipeline is also secured\n        by
          this key if ``model_to_upload`` is not set separately.\n        Overrides
          encryption_spec_key_name set in aiplatform.init.\n    model_encryption_spec_key_name
          (Optional[String]):\n        Optional. The Cloud KMS resource identifier
          of the customer\n        managed encryption key used to protect the model.
          Has the\n        form:\n        ``projects/my-project/locations/my-region/keyRings/my-kr/cryptoKeys/my-key``.\n        The
          key needs to be in the same region as where the compute\n        resource
          is created.\n        If set, the trained Model will be secured by this key.\n        Overrides
          encryption_spec_key_name set in aiplatform.init.\nReturns:\n    model: The
          trained Vertex AI Model resource or None if training did not\n        produce
          a Vertex AI Model.\n", "implementation": {"container": {"args": ["--init.project",
          {"inputValue": "project"}, "--init.location", {"inputValue": "location"},
          "--init.display_name", {"inputValue": "display_name"}, "--init.optimization_prediction_type",
          {"inputValue": "optimization_prediction_type"}, "--method.dataset", "{{$.inputs.artifacts[''dataset''].metadata[''resourceName'']}}",
          "--method.target_column", {"inputValue": "target_column"}, {"if": {"cond":
          {"isPresent": "optimization_objective"}, "then": ["--init.optimization_objective",
          {"inputValue": "optimization_objective"}]}}, {"if": {"cond": {"isPresent":
          "column_specs"}, "then": ["--init.column_specs", {"inputValue": "column_specs"}]}},
          {"if": {"cond": {"isPresent": "column_transformations"}, "then": ["--init.column_transformations",
          {"inputValue": "column_transformations"}]}}, {"if": {"cond": {"isPresent":
          "optimization_objective_recall_value"}, "then": ["--init.optimization_objective_recall_value",
          {"inputValue": "optimization_objective_recall_value"}]}}, {"if": {"cond":
          {"isPresent": "optimization_objective_precision_value"}, "then": ["--init.optimization_objective_precision_value",
          {"inputValue": "optimization_objective_precision_value"}]}}, "--init.labels",
          {"inputValue": "labels"}, {"if": {"cond": {"isPresent": "training_encryption_spec_key_name"},
          "then": ["--init.training_encryption_spec_key_name", {"inputValue": "training_encryption_spec_key_name"}]}},
          {"if": {"cond": {"isPresent": "model_encryption_spec_key_name"}, "then":
          ["--init.model_encryption_spec_key_name", {"inputValue": "model_encryption_spec_key_name"}]}},
          {"if": {"cond": {"isPresent": "training_fraction_split"}, "then": ["--method.training_fraction_split",
          {"inputValue": "training_fraction_split"}]}}, {"if": {"cond": {"isPresent":
          "validation_fraction_split"}, "then": ["--method.validation_fraction_split",
          {"inputValue": "validation_fraction_split"}]}}, {"if": {"cond": {"isPresent":
          "test_fraction_split"}, "then": ["--method.test_fraction_split", {"inputValue":
          "test_fraction_split"}]}}, {"if": {"cond": {"isPresent": "predefined_split_column_name"},
          "then": ["--method.predefined_split_column_name", {"inputValue": "predefined_split_column_name"}]}},
          {"if": {"cond": {"isPresent": "timestamp_split_column_name"}, "then": ["--method.timestamp_split_column_name",
          {"inputValue": "timestamp_split_column_name"}]}}, {"if": {"cond": {"isPresent":
          "weight_column"}, "then": ["--method.weight_column", {"inputValue": "weight_column"}]}},
          {"if": {"cond": {"isPresent": "budget_milli_node_hours"}, "then": ["--method.budget_milli_node_hours",
          {"inputValue": "budget_milli_node_hours"}]}}, {"if": {"cond": {"isPresent":
          "model_display_name"}, "then": ["--method.model_display_name", {"inputValue":
          "model_display_name"}]}}, {"if": {"cond": {"isPresent": "model_labels"},
          "then": ["--method.model_labels", {"inputValue": "model_labels"}]}}, {"if":
          {"cond": {"isPresent": "model_id"}, "then": ["--method.model_id", {"inputValue":
          "model_id"}]}}, {"if": {"cond": {"isPresent": "parent_model"}, "then": ["--method.parent_model",
          {"inputValue": "parent_model"}]}}, {"if": {"cond": {"isPresent": "is_default_version"},
          "then": ["--method.is_default_version", {"inputValue": "is_default_version"}]}},
          {"if": {"cond": {"isPresent": "model_version_aliases"}, "then": ["--method.model_version_aliases",
          {"inputValue": "model_version_aliases"}]}}, {"if": {"cond": {"isPresent":
          "model_version_description"}, "then": ["--method.model_version_description",
          {"inputValue": "model_version_description"}]}}, "--method.disable_early_stopping",
          {"inputValue": "disable_early_stopping"}, "--method.export_evaluated_data_items",
          {"inputValue": "export_evaluated_data_items"}, {"if": {"cond": {"isPresent":
          "export_evaluated_data_items_bigquery_destination_uri"}, "then": ["--method.export_evaluated_data_items_bigquery_destination_uri",
          {"inputValue": "export_evaluated_data_items_bigquery_destination_uri"}]}},
          {"if": {"cond": {"isPresent": "export_evaluated_data_items_override_destination"},
          "then": ["--method.export_evaluated_data_items_override_destination", {"inputValue":
          "export_evaluated_data_items_override_destination"}]}}, "--executor_input",
          "{{$}}", "--resource_name_output_artifact_uri", {"outputUri": "model"}],
          "command": ["python3", "-m", "google_cloud_pipeline_components.container.aiplatform.remote_runner",
          "--cls_name", "AutoMLTabularTrainingJob", "--method_name", "run"], "image":
          "gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33"}}, "inputs":
          [{"name": "project", "type": "String"}, {"default": "us-central1", "name":
          "location", "type": "String"}, {"name": "display_name", "type": "String"},
          {"name": "optimization_prediction_type", "type": "String"}, {"name": "dataset",
          "type": "google.VertexDataset"}, {"name": "target_column", "type": "String"},
          {"name": "optimization_objective", "optional": true, "type": "String"},
          {"name": "column_specs", "optional": true, "type": "JsonObject"}, {"name":
          "column_transformations", "optional": true, "type": "JsonArray"}, {"name":
          "optimization_objective_recall_value", "optional": true, "type": "Float"},
          {"name": "optimization_objective_precision_value", "optional": true, "type":
          "Float"}, {"default": "{}", "name": "labels", "optional": true, "type":
          "JsonObject"}, {"name": "training_encryption_spec_key_name", "optional":
          true, "type": "String"}, {"name": "model_encryption_spec_key_name", "optional":
          true, "type": "String"}, {"name": "training_fraction_split", "optional":
          true, "type": "Float"}, {"name": "test_fraction_split", "optional": true,
          "type": "Float"}, {"name": "validation_fraction_split", "optional": true,
          "type": "Float"}, {"name": "predefined_split_column_name", "optional": true,
          "type": "String"}, {"name": "timestamp_split_column_name", "optional": true,
          "type": "String"}, {"name": "weight_column", "optional": true, "type": "String"},
          {"name": "budget_milli_node_hours", "optional": true, "type": "Integer"},
          {"name": "model_display_name", "optional": true, "type": "String"}, {"name":
          "model_labels", "optional": true, "type": "JsonObject"}, {"name": "model_id",
          "optional": true, "type": "String"}, {"name": "parent_model", "optional":
          true, "type": "String"}, {"name": "is_default_version", "optional": true,
          "type": "Boolean"}, {"name": "model_version_aliases", "optional": true,
          "type": "JsonArray"}, {"name": "model_version_description", "optional":
          true, "type": "String"}, {"default": false, "name": "disable_early_stopping",
          "optional": true, "type": "Boolean"}, {"default": false, "name": "export_evaluated_data_items",
          "optional": true, "type": "Boolean"}, {"name": "export_evaluated_data_items_bigquery_destination_uri",
          "optional": true, "type": "String"}, {"name": "export_evaluated_data_items_override_destination",
          "optional": true, "type": "Boolean"}], "name": "automl_tabular_training_job",
          "outputs": [{"name": "model", "type": "google.VertexModel"}]}', pipelines.kubeflow.org/component_ref: '{"digest":
          "f15eada9fdfb4c87c52c39263197bf35bfd1cde4c632714115ce67dc9c42b56d", "url":
          "/home/jupyter/.local/lib/python3.7/site-packages/google_cloud_pipeline_components/aiplatform/automl_training_job/automl_tabular_training_job/component.yaml"}',
        pipelines.kubeflow.org/arguments.parameters: '{"budget_milli_node_hours":
          "2000", "column_specs": "{\"app_add_to_wishlist_month_freq_1\": \"numeric\",
          \"app_add_to_wishlist_month_freq_2\": \"numeric\", \"app_add_to_wishlist_month_freq_3\":
          \"numeric\", \"app_search_freq_month_freq_1\": \"numeric\", \"app_search_freq_month_freq_2\":
          \"numeric\", \"app_search_freq_month_freq_3\": \"numeric\", \"app_select_promotion_month_freq_1\":
          \"numeric\", \"app_select_promotion_month_freq_2\": \"numeric\", \"app_select_promotion_month_freq_3\":
          \"numeric\", \"app_sessions_freq_month_freq_1\": \"numeric\", \"app_sessions_freq_month_freq_2\":
          \"numeric\", \"app_sessions_freq_month_freq_3\": \"numeric\", \"app_view_item_month_freq_1\":
          \"numeric\", \"app_view_item_month_freq_2\": \"numeric\", \"app_view_item_month_freq_3\":
          \"numeric\", \"crm_club_level_id\": \"numeric\", \"crm_store_purchase_month_freq_1\":
          \"numeric\", \"crm_store_purchase_month_freq_2\": \"numeric\", \"crm_store_purchase_month_freq_3\":
          \"numeric\", \"weight\": \"numeric\", \"www_basket_freq_sku\": \"numeric\",
          \"www_basket_value_monthly_1\": \"numeric\", \"www_basket_value_monthly_2\":
          \"numeric\", \"www_basket_value_monthly_3\": \"numeric\", \"www_channel_freq__afiliacja\":
          \"numeric\", \"www_channel_freq__direct_organic\": \"numeric\", \"www_channel_freq__facebook\":
          \"numeric\", \"www_channel_freq__klub\": \"numeric\", \"www_channel_freq__porownywarki\":
          \"numeric\", \"www_channel_freq__portale\": \"numeric\", \"www_channel_freq__retargeting\":
          \"numeric\", \"www_channel_freq__sem\": \"numeric\", \"www_channel_freq__traffic\":
          \"numeric\", \"www_coupon_add_month_1\": \"numeric\", \"www_coupon_add_month_2\":
          \"numeric\", \"www_coupon_add_month_3\": \"numeric\", \"www_device_freq_desktop\":
          \"numeric\", \"www_device_freq_mobile\": \"numeric\", \"www_esizeme_freq_esizeme_filtr\":
          \"numeric\", \"www_esizeme_freq_esizme_applied\": \"numeric\", \"www_gallery_click_month_1\":
          \"numeric\", \"www_gallery_click_month_2\": \"numeric\", \"www_gallery_click_month_3\":
          \"numeric\", \"www_pages_visited_month_1\": \"numeric\", \"www_pages_visited_month_2\":
          \"numeric\", \"www_pages_visited_month_3\": \"numeric\", \"www_product_trans_freq_damskie_buty\":
          \"numeric\", \"www_product_trans_freq_dzieciece\": \"numeric\", \"www_product_trans_freq_meskie_buty\":
          \"numeric\", \"www_product_trans_freq_torby\": \"numeric\", \"www_promo_click_month_1\":
          \"numeric\", \"www_promo_click_month_2\": \"numeric\", \"www_promo_click_month_3\":
          \"numeric\", \"www_time_onsite_avg_month_1\": \"numeric\", \"www_time_onsite_avg_month_2\":
          \"numeric\", \"www_time_onsite_avg_month_3\": \"numeric\", \"www_trans_month_freq_1\":
          \"numeric\", \"www_trans_month_freq_2\": \"numeric\", \"www_trans_month_freq_3\":
          \"numeric\", \"www_umbrella_click_month_1\": \"numeric\", \"www_umbrella_click_month_2\":
          \"numeric\", \"www_umbrella_click_month_3\": \"numeric\", \"www_visits_add_fav_1\":
          \"numeric\", \"www_visits_add_fav_2\": \"numeric\", \"www_visits_add_fav_3\":
          \"numeric\", \"www_visits_month_freq_1\": \"numeric\", \"www_visits_month_freq_2\":
          \"numeric\", \"www_visits_month_freq_3\": \"numeric\", \"y_if_trans\": \"numeric\"}",
          "disable_early_stopping": "False", "display_name": "train-automl-{{inputs.parameters.in_prefix}}",
          "export_evaluated_data_items": "False", "labels": "{}", "location": "us-central1",
          "model_display_name": "promo-classification-automl-{{inputs.parameters.in_prefix}}",
          "optimization_objective": "maximize-au-roc", "optimization_prediction_type":
          "classification", "project": "{{inputs.parameters.in_vertexai_projectid}}",
          "target_column": "y_if_trans", "test_fraction_split": "0.2", "training_fraction_split":
          "0.6", "validation_fraction_split": "0.2", "weight_column": "weight"}'}
  - name: endpoint-create
    container:
      args: [--type, CreateEndpoint, --payload, '{"display_name": "promo-classification-{{inputs.parameters.in_prefix}}-endpoint",
          "description": "", "labels": {}, "encryption_spec": {"kms_key_name":""},
          "network": ""}', --project, '{{inputs.parameters.in_vertexai_projectid}}',
        --location, us-central1, --gcp_resources, /tmp/outputs/gcp_resources/data,
        --executor_input, '{{$}}']
      command: [python3, -u, -m, google_cloud_pipeline_components.container.v1.endpoint.create_endpoint.launcher]
      image: gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33
    inputs:
      parameters:
      - {name: in_prefix}
      - {name: in_vertexai_projectid}
    outputs:
      artifacts:
      - {name: endpoint-create-endpoint, path: /tmp/outputs/endpoint/data}
      - {name: endpoint-create-gcp_resources, path: /tmp/outputs/gcp_resources/data}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.14
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
      annotations: {pipelines.kubeflow.org/component_spec: '{"description": "Creates
          a Google Cloud Vertex Endpoint and waits for it to be ready.\nFor more details,
          see https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/create.\n\nArgs:\n    project
          (str):\n        Required. Project to create the endpoint.\n    location
          (Optional[str]):\n        Location to create the endpoint. If not set, default
          to us-central1.\n    display_name (str):\n        Required. The user-defined
          name of the Endpoint.\n        The name can be up to 128 characters long
          and can be consist\n        of any UTF-8 characters.\n    description (Optional[str]):\n        The
          description of the Endpoint.\n    labels (Optional[dict]):\n        The
          labels with user-defined metadata to organize your Endpoints.\n\n        Label
          keys and values can be no longer than 64\n        characters (Unicode codepoints),
          can only\n        contain lowercase letters, numeric characters,\n        underscores
          and dashes. International characters\n        are allowed.\n\n        See
          https://goo.gl/xmQnxf for more information and examples of labels.\n    encryption_spec_key_name
          (Optional[str]):\n        Customer-managed encryption key spec for an Endpoint.
          If set,\n        this Endpoint and all of this Endoint''s sub-resources
          will be secured by this key.\n        Has the form:\n        ``projects/my-project/locations/my-location/keyRings/my-kr/cryptoKeys/my-key``.\n        The
          key needs to be in the same region as where the compute\n        resource
          is created.\n\n        If set, this Endpoint and all sub-resources of this
          Endpoint will be secured by this key.\n    network (Optional[str]):\n        The
          full name of the Google Compute Engine network to which the\n        Endpoint
          should be peered. Private services access must already be configured for\n        the
          network. If left unspecified, the Endpoint is not peered with any network.\n\n        [Format](https://cloud.google.com/compute/docs/reference/rest/v1/networks/insert):\n        projects/{project}/global/networks/{network}.\n        Where
          {project} is a project number, as in ''12345'', and {network} is network
          name.\nReturns:\n    endpoint (google.VertexEndpoint):\n        Artifact
          tracking the created endpoint.\n    gcp_resources (str):\n        Serialized
          gcp_resources proto tracking the create endpoint''s long running operation.\n\n        For
          more details, see https://github.com/kubeflow/pipelines/blob/master/components/google-cloud/google_cloud_pipeline_components/proto/README.md.\n",
          "implementation": {"container": {"args": ["--type", "CreateEndpoint", "--payload",
          {"concat": ["{", "\"display_name\": \"", {"inputValue": "display_name"},
          "\"", ", \"description\": \"", {"inputValue": "description"}, "\"", ", \"labels\":
          ", {"inputValue": "labels"}, ", \"encryption_spec\": {\"kms_key_name\":\"",
          {"inputValue": "encryption_spec_key_name"}, "\"}", ", \"network\": \"",
          {"inputValue": "network"}, "\"", "}"]}, "--project", {"inputValue": "project"},
          "--location", {"inputValue": "location"}, "--gcp_resources", {"outputPath":
          "gcp_resources"}, "--executor_input", "{{$}}"], "command": ["python3", "-u",
          "-m", "google_cloud_pipeline_components.container.v1.endpoint.create_endpoint.launcher"],
          "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33"}},
          "inputs": [{"name": "project", "type": "String"}, {"default": "us-central1",
          "name": "location", "type": "String"}, {"name": "display_name", "type":
          "String"}, {"default": "", "name": "description", "optional": true, "type":
          "String"}, {"default": "{}", "name": "labels", "optional": true, "type":
          "JsonObject"}, {"default": "", "name": "encryption_spec_key_name", "optional":
          true, "type": "String"}, {"default": "", "name": "network", "optional":
          true, "type": "String"}], "name": "endpoint_create", "outputs": [{"name":
          "endpoint", "type": "google.VertexEndpoint"}, {"name": "gcp_resources",
          "type": "String"}]}', pipelines.kubeflow.org/component_ref: '{"digest":
          "4fe1d732b307041458b6b1001d130b60d5d12471d91ffdcbc570f7866c8e5c5e", "url":
          "/home/jupyter/.local/lib/python3.7/site-packages/google_cloud_pipeline_components/aiplatform/endpoint/create_endpoint/component.yaml"}',
        pipelines.kubeflow.org/arguments.parameters: '{"description": "", "display_name":
          "promo-classification-{{inputs.parameters.in_prefix}}-endpoint", "encryption_spec_key_name":
          "", "labels": "{}", "location": "us-central1", "network": "", "project":
          "{{inputs.parameters.in_vertexai_projectid}}"}'}
  - name: model-deploy
    container:
      args: [--type, DeployModel, --payload, '{"endpoint": "{{$.inputs.artifacts[''endpoint''].metadata[''resourceName'']}}",
          "traffic_split": {"0": "100"}, "deployed_model": {"model": "{{$.inputs.artifacts[''model''].metadata[''resourceName'']}}",
          "dedicated_resources": {"machine_spec": {"machine_type": "n1-standard-4",
          "accelerator_type": "", "accelerator_count": 0}, "min_replica_count": 1,
          "max_replica_count": 2}, "automatic_resources": {"min_replica_count": 0,
          "max_replica_count": 0}, "service_account": "", "disable_container_logging":
          False, "enable_access_logging": False, "explanation_spec": {"parameters":
          {}, "metadata": {}}}}', --project, '', --location, '', --gcp_resources,
        /tmp/outputs/gcp_resources/data]
      command: [python3, -u, -m, google_cloud_pipeline_components.container.v1.endpoint.deploy_model.launcher]
      image: gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33
    inputs:
      artifacts:
      - name: deployed_model_display_name
        path: /tmp/inputs/deployed_model_display_name/data
        raw: {data: ''}
      - {name: endpoint-create-endpoint, path: /tmp/inputs/endpoint/data}
      - {name: automl-tabular-training-job-model, path: /tmp/inputs/model/data}
    outputs:
      artifacts:
      - {name: model-deploy-gcp_resources, path: /tmp/outputs/gcp_resources/data}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.14
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
      annotations: {pipelines.kubeflow.org/component_spec: '{"description": "Deploys
          a Google Cloud Vertex Model to the Endpoint, creating a DeployedModel within
          it.\nFor more details, see https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/deployModel.\n\nArgs:\n    model
          (google.VertexModel):\n        Required. The model to be deployed.\n    endpoint
          (google.VertexEndpoint):\n        Required. The endpoint to be deployed
          to.\n    deployed_model_display_name (Optional[str]):\n        The display
          name of the DeployedModel. If not provided\n        upon creation, the Model''s
          display_name is used.\n    traffic_split (Optional[Dict[str, int]]):\n        A
          map from a DeployedModel''s ID to the percentage\n        of this Endpoint''s
          traffic that should be forwarded to that DeployedModel.\n\n        If this
          field is non-empty, then the Endpoint''s trafficSplit\n        will be overwritten
          with it. To refer to the ID of the just\n        being deployed Model, a
          \"0\" should be used, and the actual ID\n        of the new DeployedModel
          will be filled in its place by this method.\n        The traffic percentage
          values must add up to 100.\n\n        If this field is empty, then the Endpoint''s
          trafficSplit is not updated.\n    dedicated_resources_machine_type (Optional[str]):\n        The
          specification of a single machine used by the prediction.\n\n        This
          field is required if `automatic_resources_min_replica_count` is not specified.\n\n        For
          more details, see https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints#dedicatedresources.\n    dedicated_resources_accelerator_type
          (Optional[str]):\n        Hardware accelerator type. Must also set accelerator_count
          if used.\n        See https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec#AcceleratorType\n        for
          available options.\n\n        This field is required if `dedicated_resources_machine_type`
          is specified.\n    dedicated_resources_accelerator_count (Optional[int]):\n        The
          number of accelerators to attach to a worker replica.\n    dedicated_resources_min_replica_count
          (Optional[int]):\n        The minimum number of machine replicas this DeployedModel
          will be\n        always deployed on. This value must be greater than or
          equal to 1.\n        If traffic against the DeployedModel increases, it
          may dynamically be deployed\n        onto more replicas, and as traffic
          decreases, some of these extra replicas may be freed.\n    dedicated_resources_max_replica_count
          (Optional[int]):\n        The maximum number of replicas this deployed model
          may\n        the larger value of min_replica_count or 1 will\n        be
          used. If value provided is smaller than min_replica_count, it\n        will
          automatically be increased to be min_replica_count.\n        The maximum
          number of replicas this deployed model may\n        be deployed on when
          the traffic against it increases. If requested\n        value is too large,
          the deployment will error, but if deployment\n        succeeds then the
          ability to scale the model to that many replicas\n        is guaranteed
          (barring service outages). If traffic against the\n        deployed model
          increases beyond what its replicas at maximum may\n        handle, a portion
          of the traffic will be dropped. If this value\n        is not provided,
          will use dedicated_resources_min_replica_count as\n        the default value.\n    automatic_resources_min_replica_count
          (Optional[int]):\n        The minimum number of replicas this DeployedModel\n        will
          be always deployed on. If traffic against it increases,\n        it may
          dynamically be deployed onto more replicas up to\n        automatic_resources_max_replica_count,
          and as traffic decreases,\n        some of these extra replicas may be freed.
          If the requested value\n        is too large, the deployment will error.\n\n        This
          field is required if `dedicated_resources_machine_type` is not specified.\n    automatic_resources_max_replica_count
          (Optional[int]):\n        The maximum number of replicas this DeployedModel
          may\n        be deployed on when the traffic against it increases. If the
          requested\n        value is too large, the deployment will error, but if
          deployment\n        succeeds then the ability to scale the model to that
          many replicas\n        is guaranteed (barring service outages). If traffic
          against the\n        DeployedModel increases beyond what its replicas at
          maximum may handle,\n        a portion of the traffic will be dropped. If
          this value is not provided,\n        a no upper bound for scaling under
          heavy traffic will be assume,\n        though Vertex AI may be unable to
          scale beyond certain replica number.\n    service_account (Optional[str]):\n        The
          service account that the DeployedModel''s container runs as. Specify the\n        email
          address of the service account. If this service account is not\n        specified,
          the container runs as a service account that doesn''t have access\n        to
          the resource project.\n\n        Users deploying the Model must have the
          `iam.serviceAccounts.actAs`\n        permission on this service account.\n    disable_container_logging
          (Optional[bool]):\n        For custom-trained Models and AutoML Tabular
          Models, the container of the\n        DeployedModel instances will send
          stderr and stdout streams to Stackdriver\n        Logging by default. Please
          note that the logs incur cost, which are subject\n        to Cloud Logging
          pricing.\n\n        User can disable container logging by setting this flag
          to true.\n    enable_access_logging (Optional[bool]):\n        These logs
          are like standard server access logs, containing information like\n        timestamp
          and latency for each prediction request.\n\n        Note that Stackdriver
          logs may incur a cost, especially if your project\n        receives prediction
          requests at a high queries per second rate (QPS).\n        Estimate your
          costs before enabling this option.\n    explanation_metadata (Optional[dict]):\n        Metadata
          describing the Model''s input and output for explanation.\n\n        For
          more details, see https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#explanationmetadata.\n    explanation_parameters
          (Optional[dict]):\n        Parameters that configure explaining information
          of the Model''s predictions.\n\n        For more details, see https://cloud.google.com/vertex-ai/docs/reference/rest/v1/ExplanationSpec#explanationmetadata.\nReturns:\n    gcp_resources
          (str):\n        Serialized gcp_resources proto tracking the deploy model''s
          long running operation.\n\n        For more details, see https://github.com/kubeflow/pipelines/blob/master/components/google-cloud/google_cloud_pipeline_components/proto/README.md.\n",
          "implementation": {"container": {"args": ["--type", "DeployModel", "--payload",
          {"concat": ["{", "\"endpoint\": \"", "{{$.inputs.artifacts[''endpoint''].metadata[''resourceName'']}}",
          "\"", ", \"traffic_split\": ", {"inputValue": "traffic_split"}, ", \"deployed_model\":
          {", "\"model\": \"", "{{$.inputs.artifacts[''model''].metadata[''resourceName'']}}",
          "\"", ", \"dedicated_resources\": {", "\"machine_spec\": {", "\"machine_type\":
          \"", {"inputValue": "dedicated_resources_machine_type"}, "\"", ", \"accelerator_type\":
          \"", {"inputValue": "dedicated_resources_accelerator_type"}, "\"", ", \"accelerator_count\":
          ", {"inputValue": "dedicated_resources_accelerator_count"}, "}", ", \"min_replica_count\":
          ", {"inputValue": "dedicated_resources_min_replica_count"}, ", \"max_replica_count\":
          ", {"inputValue": "dedicated_resources_max_replica_count"}, "}", ", \"automatic_resources\":
          {", "\"min_replica_count\": ", {"inputValue": "automatic_resources_min_replica_count"},
          ", \"max_replica_count\": ", {"inputValue": "automatic_resources_max_replica_count"},
          "}", ", \"service_account\": \"", {"inputValue": "service_account"}, "\"",
          ", \"disable_container_logging\": ", {"inputValue": "disable_container_logging"},
          ", \"enable_access_logging\": ", {"inputValue": "enable_access_logging"},
          ", \"explanation_spec\": {", "\"parameters\": ", {"inputValue": "explanation_parameters"},
          ", \"metadata\": ", {"inputValue": "explanation_metadata"}, "}", "}", "}"]},
          "--project", "", "--location", "", "--gcp_resources", {"outputPath": "gcp_resources"}],
          "command": ["python3", "-u", "-m", "google_cloud_pipeline_components.container.v1.endpoint.deploy_model.launcher"],
          "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33"}},
          "inputs": [{"name": "model", "type": "google.VertexModel"}, {"name": "endpoint",
          "optional": true, "type": "google.VertexEndpoint"}, {"default": "", "name":
          "deployed_model_display_name", "optional": true, "type": "String"}, {"default":
          "{}", "name": "traffic_split", "optional": true, "type": "JsonObject"},
          {"default": "", "name": "dedicated_resources_machine_type", "optional":
          true, "type": "String"}, {"default": 0, "name": "dedicated_resources_min_replica_count",
          "optional": true, "type": "Integer"}, {"default": 0, "name": "dedicated_resources_max_replica_count",
          "optional": true, "type": "Integer"}, {"default": "", "name": "dedicated_resources_accelerator_type",
          "optional": true, "type": "String"}, {"default": 0, "name": "dedicated_resources_accelerator_count",
          "optional": true, "type": "Integer"}, {"default": 0, "name": "automatic_resources_min_replica_count",
          "optional": true, "type": "Integer"}, {"default": 0, "name": "automatic_resources_max_replica_count",
          "optional": true, "type": "Integer"}, {"default": "", "name": "service_account",
          "optional": true, "type": "String"}, {"default": false, "name": "disable_container_logging",
          "optional": true, "type": "Boolean"}, {"default": false, "name": "enable_access_logging",
          "optional": true, "type": "Boolean"}, {"default": "{}", "name": "explanation_metadata",
          "optional": true, "type": "JsonObject"}, {"default": "{}", "name": "explanation_parameters",
          "optional": true, "type": "JsonObject"}], "name": "model_deploy", "outputs":
          [{"name": "gcp_resources", "type": "String"}]}', pipelines.kubeflow.org/component_ref: '{"digest":
          "0682cb16077195d268fdaa46c74308258c26074d8a6f988964a4c0d1f7a92650", "url":
          "/home/jupyter/.local/lib/python3.7/site-packages/google_cloud_pipeline_components/aiplatform/endpoint/deploy_model/component.yaml"}',
        pipelines.kubeflow.org/arguments.parameters: '{"automatic_resources_max_replica_count":
          "0", "automatic_resources_min_replica_count": "0", "dedicated_resources_accelerator_count":
          "0", "dedicated_resources_accelerator_type": "", "dedicated_resources_machine_type":
          "n1-standard-4", "dedicated_resources_max_replica_count": "2", "dedicated_resources_min_replica_count":
          "1", "disable_container_logging": "False", "enable_access_logging": "False",
          "explanation_metadata": "{}", "explanation_parameters": "{}", "service_account":
          "", "traffic_split": "{\"0\": \"100\"}"}'}
  - name: tabular-dataset-create
    container:
      args: [--method.project, '{{inputs.parameters.in_vertexai_projectid}}', --method.location,
        us-central1, --method.display_name, ccc-dataset, --method.bq_source, 'bq://{{inputs.parameters.in_bigquery_projectid}}.{{inputs.parameters.in_bigquery_dataset}}.{{inputs.parameters.in_bigquery_table}}',
        --method.labels, '{}', --executor_input, '{{$}}', --resource_name_output_artifact_uri,
        '{{$.outputs.artifacts[''dataset''].uri}}']
      command: [python3, -m, google_cloud_pipeline_components.container.aiplatform.remote_runner,
        --cls_name, TabularDataset, --method_name, create]
      image: gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33
    inputs:
      parameters:
      - {name: in_bigquery_dataset}
      - {name: in_bigquery_projectid}
      - {name: in_bigquery_table}
      - {name: in_vertexai_projectid}
    outputs:
      artifacts:
      - {name: tabular-dataset-create-dataset, path: /tmp/outputs/dataset/data}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.14
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
      annotations: {pipelines.kubeflow.org/component_spec: '{"description": "Creates
          a new tabular dataset.\nArgs:\n    display_name (String):\n        Required.
          The user-defined name of the Dataset.\n        The name can be up to 128
          characters long and can be consist\n        of any UTF-8 characters.\n    gcs_source
          (Union[str, Sequence[str]]):\n        Google Cloud Storage URI(-s) to the\n        input
          file(s). May contain wildcards. For more\n        information on wildcards,
          see\n        https://cloud.google.com/storage/docs/gsutil/addlhelp/WildcardNames.\n        examples:\n            str:
          \"gs://bucket/file.csv\"\n            Sequence[str]: [\"gs://bucket/file1.csv\",
          \"gs://bucket/file2.csv\"]\n    bq_source (String):\n        BigQuery URI
          to the input table.\n        example:\n            \"bq://project.dataset.table_name\"\n    project
          (String):\n        Required. project to retrieve dataset from.\n    location
          (String):\n        Optional location to retrieve dataset from.\n    labels
          (JsonObject):\n        Optional. Labels with user-defined metadata to organize
          your Tensorboards.\n        Label keys and values can be no longer than
          64 characters\n        (Unicode codepoints), can only contain lowercase
          letters, numeric\n        characters, underscores and dashes. International
          characters are allowed.\n        No more than 64 user labels can be associated
          with one Tensorboard\n        (System labels are excluded).\n        See
          https://goo.gl/xmQnxf for more information and examples of labels.\n        System
          reserved label keys are prefixed with \"aiplatform.googleapis.com/\"\n        and
          are immutable.\n    encryption_spec_key_name (Optional[String]):\n        Optional.
          The Cloud KMS resource identifier of the customer\n        managed encryption
          key used to protect the dataset. Has the\n        form:\n        ``projects/my-project/locations/my-region/keyRings/my-kr/cryptoKeys/my-key``.\n        The
          key needs to be in the same region as where the compute\n        resource
          is created.\n        If set, this Dataset and all sub-resources of this
          Dataset will be secured by this key.\n        Overrides encryption_spec_key_name
          set in aiplatform.init.\nReturns:\n    tabular_dataset (TabularDataset):\n        Instantiated
          representation of the managed tabular dataset resource.\n", "implementation":
          {"container": {"args": ["--method.project", {"inputValue": "project"}, "--method.location",
          {"inputValue": "location"}, "--method.display_name", {"inputValue": "display_name"},
          {"if": {"cond": {"isPresent": "gcs_source"}, "then": ["--method.gcs_source",
          {"inputValue": "gcs_source"}]}}, {"if": {"cond": {"isPresent": "bq_source"},
          "then": ["--method.bq_source", {"inputValue": "bq_source"}]}}, "--method.labels",
          {"inputValue": "labels"}, {"if": {"cond": {"isPresent": "encryption_spec_key_name"},
          "then": ["--method.encryption_spec_key_name", {"inputValue": "encryption_spec_key_name"}]}},
          "--executor_input", "{{$}}", "--resource_name_output_artifact_uri", {"outputUri":
          "dataset"}], "command": ["python3", "-m", "google_cloud_pipeline_components.container.aiplatform.remote_runner",
          "--cls_name", "TabularDataset", "--method_name", "create"], "image": "gcr.io/ml-pipeline/google-cloud-pipeline-components:1.0.33"}},
          "inputs": [{"name": "project", "type": "String"}, {"default": "us-central1",
          "name": "location", "type": "String"}, {"name": "display_name", "type":
          "String"}, {"name": "gcs_source", "optional": true, "type": "String"}, {"name":
          "bq_source", "optional": true, "type": "String"}, {"default": "{}", "name":
          "labels", "optional": true, "type": "JsonObject"}, {"name": "encryption_spec_key_name",
          "optional": true, "type": "String"}], "name": "tabular_dataset_create",
          "outputs": [{"name": "dataset", "type": "google.VertexDataset"}]}', pipelines.kubeflow.org/component_ref: '{"digest":
          "9e4cbdda4816f9590dc9efce65276059f9dcf2bc91f025f434327bef987f7002", "url":
          "/home/jupyter/.local/lib/python3.7/site-packages/google_cloud_pipeline_components/aiplatform/dataset/create_tabular_dataset/component.yaml"}',
        pipelines.kubeflow.org/arguments.parameters: '{"bq_source": "bq://{{inputs.parameters.in_bigquery_projectid}}.{{inputs.parameters.in_bigquery_dataset}}.{{inputs.parameters.in_bigquery_table}}",
          "display_name": "ccc-dataset", "labels": "{}", "location": "us-central1",
          "project": "{{inputs.parameters.in_vertexai_projectid}}"}'}
  - name: wf-ccc-ex2-automl-dataset
    inputs:
      parameters:
      - {name: in_bigquery_dataset}
      - {name: in_bigquery_projectid}
      - {name: in_bigquery_table}
      - {name: in_prefix}
      - {name: in_vertexai_projectid}
    dag:
      tasks:
      - name: automl-tabular-training-job
        template: automl-tabular-training-job
        dependencies: [tabular-dataset-create]
        arguments:
          parameters:
          - {name: in_prefix, value: '{{inputs.parameters.in_prefix}}'}
          - {name: in_vertexai_projectid, value: '{{inputs.parameters.in_vertexai_projectid}}'}
          artifacts:
          - {name: tabular-dataset-create-dataset, from: '{{tasks.tabular-dataset-create.outputs.artifacts.tabular-dataset-create-dataset}}'}
      - name: endpoint-create
        template: endpoint-create
        arguments:
          parameters:
          - {name: in_prefix, value: '{{inputs.parameters.in_prefix}}'}
          - {name: in_vertexai_projectid, value: '{{inputs.parameters.in_vertexai_projectid}}'}
      - name: model-deploy
        template: model-deploy
        dependencies: [automl-tabular-training-job, endpoint-create]
        arguments:
          artifacts:
          - {name: automl-tabular-training-job-model, from: '{{tasks.automl-tabular-training-job.outputs.artifacts.automl-tabular-training-job-model}}'}
          - {name: endpoint-create-endpoint, from: '{{tasks.endpoint-create.outputs.artifacts.endpoint-create-endpoint}}'}
      - name: tabular-dataset-create
        template: tabular-dataset-create
        arguments:
          parameters:
          - {name: in_bigquery_dataset, value: '{{inputs.parameters.in_bigquery_dataset}}'}
          - {name: in_bigquery_projectid, value: '{{inputs.parameters.in_bigquery_projectid}}'}
          - {name: in_bigquery_table, value: '{{inputs.parameters.in_bigquery_table}}'}
          - {name: in_vertexai_projectid, value: '{{inputs.parameters.in_vertexai_projectid}}'}
  arguments:
    parameters:
    - {name: in_prefix, value: demo}
    - {name: in_bigquery_projectid, value: projektccc}
    - {name: in_bigquery_dataset, value: crm_cookie_match}
    - {name: in_bigquery_table, value: crm_cookie_match}
    - {name: in_vertexai_projectid, value: defaultprojectid}
    - {name: in_vertexai_region, value: us-central1}
  serviceAccountName: pipeline-runner
